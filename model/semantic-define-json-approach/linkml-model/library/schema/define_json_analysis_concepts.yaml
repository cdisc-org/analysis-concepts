id: https://cdisc.org/analysis-concepts
name: define-json-analysis-concepts
title: Define-JSON Analysis Concepts Schema
description: >-
  LinkML schema for Define-JSON extensions supporting Analysis Concepts,
  Data Concepts, Building Blocks, and Biomedical Concepts with full
  inheritance hierarchy and semantic relationships.
version: 1.0.0
license: https://creativecommons.org/licenses/by/4.0/

prefixes:
  linkml: https://w3id.org/linkml/
  cdisc: https://cdisc.org/
  stato: http://purl.obolibrary.org/obo/STATO_
  obo: http://purl.obolibrary.org/obo/
  schema: http://schema.org/
  dcterms: http://purl.org/dc/terms/

default_prefix: cdisc
default_range: string

imports:
  - linkml:types

# ============================================================================
# ENUMERATIONS - Controlled Vocabularies
# ============================================================================

enums:
  ConceptTypeEnum:
    description: Type discriminator for reified concepts
    permissible_values:
      analysis_concept:
        description: Statistical analysis pattern specification
      derivation_concept:
        description: Abstract data semantic or derivation specification
      building_block:
        description: Reusable phrase template for sentence composition
      biomedical_concept:
        description: Clinical semantic concept

  DataTypeEnum:
    description: Standard data types for variables and parameters
    permissible_values:
      float:
        description: Floating point number
      integer:
        description: Whole number
      text:
        description: Character string
      date:
        description: Date value
      datetime:
        description: Date and time value
      boolean:
        description: True/false value
      categorical:
        description: Categorical value
      continuous:
        description: Continuous numeric value
      list:
        description: List of values
      matrix:
        description: Matrix of values

  AdamClassEnum:
    description: Standard ADaM variable classes
    permissible_values:
      CHG:
        description: Change from baseline
      BASE:
        description: Baseline value
      AVAL:
        description: Analysis value
      PCHG:
        description: Percent change from baseline
      R2BASE:
        description: Ratio to baseline
      TIMING:
        description: Timing variable
      DERIVATION:
        description: Derivation variable
      IDENTIFIER:
        description: Identifier variable
      OCCURRENCE:
        description: Occurrence indicator
      INTERVENTION:
        description: Intervention variable
      CATEGORIZATION:
        description: Categorization variable
      RELATIONSHIP:
        description: Relationship variable

  MethodCategoryEnum:
    description: Categories of statistical and derivation methods
    permissible_values:
      statistical_test:
        description: Statistical hypothesis test
      estimation:
        description: Parameter estimation method
      derivation:
        description: Data derivation method
      comparison:
        description: Comparison method
      modeling:
        description: Statistical modeling method
      statistical_analysis:
        description: General statistical analysis
      descriptive:
        description: Descriptive statistics
      arithmetic_operation:
        description: Arithmetic computation

  MethodTypeDiscriminatorEnum:
    description: Type discriminator for method hierarchy
    permissible_values:
      statistical_method:
        description: Statistical analysis method
      derivation_method:
        description: Data derivation method

  MethodTypeEnum:
    description: Specific types of statistical methods
    permissible_values:
      linear_model:
        description: Linear regression model
      generalized_linear_model:
        description: Generalized linear model
      mixed_effects_model:
        description: Mixed effects model
      survival_analysis:
        description: Survival analysis method
      non_parametric_test:
        description: Non-parametric statistical test
      bayesian_method:
        description: Bayesian analysis method
      analysis_of_covariance:
        description: ANCOVA method
      arithmetic_expression:
        description: Arithmetic formula
      logical_expression:
        description: Logical expression

  SemanticRoleAnalysisConceptEnum:
    description: Semantic roles for analysis concepts
    permissible_values:
      statistical_analysis_pattern:
        description: Statistical analysis pattern
      descriptive_analysis_pattern:
        description: Descriptive analysis pattern
      exploratory_analysis_pattern:
        description: Exploratory analysis pattern
      confirmatory_analysis_pattern:
        description: Confirmatory analysis pattern

  SemanticRoleBuildingBlockEnum:
    description: Semantic roles for building blocks
    permissible_values:
      outcome_specification:
        description: Specifies outcome measure
      analysis_method_specification:
        description: Specifies analysis method
      predictor_specification:
        description: Specifies predictor variable
      covariate_adjustment_specification:
        description: Specifies covariate adjustment
      population_specification:
        description: Specifies analysis population
      grouping_specification:
        description: Specifies grouping factors
      method_specification:
        description: Specifies statistical method
      timepoint_specification:
        description: Specifies temporal reference

  SemanticRoleInputEnum:
    description: Semantic roles for concept inputs
    permissible_values:
      dependent_variable:
        description: Dependent variable in analysis
      primary_predictor:
        description: Primary predictor variable
      secondary_predictor:
        description: Secondary predictor variable
      confounding_adjuster:
        description: Confounding adjustment variable
      adjustment_variable:
        description: General adjustment variable
      baseline_covariate:
        description: Baseline covariate
      population_filter:
        description: Population filtering criterion
      stratification_variable:
        description: Stratification variable
      temporal_selector:
        description: Temporal selection criterion
      measurement_identifier:
        description: Measurement identifier
      analysis_set_selector:
        description: Analysis set selector
      analyzed_variable:
        description: Variable being analyzed
      grouping_factor:
        description: Grouping factor
      primary_factor:
        description: Primary treatment factor

  SemanticRoleOutputEnum:
    description: Semantic roles for concept outputs
    permissible_values:
      statistical_evidence:
        description: Statistical evidence (p-value, test statistic)
      effect_estimate:
        description: Effect size estimate
      uncertainty_estimate:
        description: Uncertainty measure (SE, SD)
      confidence_interval:
        description: Confidence interval
      interval_estimate:
        description: Interval estimate
      model_fit:
        description: Model fit statistic
      quality_metric:
        description: Quality or performance metric
      diagnostic:
        description: Diagnostic statistic
      adjusted_means:
        description: Adjusted mean estimates
      sample_size:
        description: Sample size
      central_tendency:
        description: Central tendency measure
      dispersion:
        description: Dispersion measure
      range_bound:
        description: Range boundary value

  SemanticRoleDerivationConceptEnum:
    description: Semantic roles for derivation concepts
    permissible_values:
      derived_endpoint:
        description: Derived endpoint variable
      measurement:
        description: Measurement variable
      reference_measurement:
        description: Reference measurement (e.g., baseline)
      treatment_quantification:
        description: Treatment quantity or dose
      confounding_adjuster:
        description: Confounding adjustment variable
      subject_selection:
        description: Subject selection criterion
      temporal_selector:
        description: Temporal selection
      treatment_classification:
        description: Treatment classification
      derived_value:
        description: Derived value
      analysis_variable:
        description: Analysis variable
      covariate:
        description: Covariate variable
      filtered_dataset:
        description: Filtered dataset

  MappingTypeEnum:
    description: Type of parameter mapping between building blocks and concepts
    permissible_values:
      provides_input:
        description: Building block parameter provides input to concept
      describes_output:
        description: Building block parameter describes output from concept

  ImplementationLanguageEnum:
    description: Programming languages for method implementations
    permissible_values:
      R:
        description: R statistical language
      SAS:
        description: SAS statistical software
      Python:
        description: Python programming language
      Julia:
        description: Julia programming language
      MATLAB:
        description: MATLAB numerical computing environment

# ============================================================================
# CLASSES - Core Concept Hierarchy
# ============================================================================

classes:

  # --------------------------------------------------------------------------
  # Abstract Base Class
  # --------------------------------------------------------------------------

  ReifiedConcept:
    abstract: true
    description: >-
      Abstract base class for all reified concepts (AnalysisConcept,
      DerivationConcept, BuildingBlock, BiomedicalConcept). Defines shared
      properties inherited by all concept types.
    slots:
      - OID
      - name
      - description
      - conceptType
      - semanticRole
      - label
      - statoIRI
    slot_usage:
      OID:
        required: true
        identifier: true
        pattern: "^(AC|DC|BB|BC|METHOD)\\."
      name:
        required: true
      conceptType:
        required: true

  # --------------------------------------------------------------------------
  # Specialized Concept Classes
  # --------------------------------------------------------------------------

  AnalysisConcept:
    is_a: ReifiedConcept
    description: >-
      Statistical analysis pattern specification. Represents a reusable
      analysis concept that can be instantiated in specific studies.
      Contains statistical semantics including required inputs, expected
      outputs, and analysis methods.
    slots:
      - purpose
      - requiredBuildingBlocks
      - inputs
      - outputs
      - methodReferences
      - requiredDerivationConcepts
      - requiredAnalysisConcepts
      - requiredBiomedicalConcepts
      - requiresPopulation
      - allowedDataConcepts
    slot_usage:
      OID:
        pattern: "^AC\\."
      conceptType:
        equals_string: "analysis_concept"
      purpose:
        required: true
      inputs:
        required: true
        multivalued: true
      outputs:
        required: true
        multivalued: true

  DerivationConcept:
    is_a: ReifiedConcept
    description: >-
      Abstract data semantic specification. Represents a reusable derivation
      concept that can be implemented by study-specific variables. Contains
      data semantics including data type, ADaM class, and optional derivation
      specifications. Also called DataConcept.
    slots:
      - adClass
      - dataType
      - derivationMethod
      - mapsToVariable
      - inputs
      - outputs
      - requiredDerivationConcepts
      - requiredBiomedicalConcepts
    slot_usage:
      OID:
        pattern: "^DC\\."
      conceptType:
        equals_string: "derivation_concept"
      inputs:
        required: true
        multivalued: true
      outputs:
        required: true
        multivalued: true

  BuildingBlock:
    is_a: ReifiedConcept
    description: >-
      Reusable phrase template for analysis sentence composition. Represents
      a template with parameter placeholders that can be filled during Step 1
      of the workflow to compose human-readable analysis sentences.
    slots:
      - template
      - parameters
      - mapsToDataConcept
      - requiresAnalysisConcept
      - examples
    slot_usage:
      OID:
        pattern: "^BB\\."
      conceptType:
        equals_string: "building_block"
      template:
        required: true
      parameters:
        required: true
        multivalued: true

  BiomedicalConcept:
    is_a: ReifiedConcept
    description: >-
      Clinical semantic concept representing biomedical domain knowledge.
      Defines abstract clinical semantics without implementation mappings.
      Related to SDTM and ADaM variables through implementsConcept relationships
      in study instances.
    slots:
      - biomedicalDomain
      - ctCodelistRef
      - relatedDataConcepts
      - implementationGuidance
    slot_usage:
      OID:
        pattern: "^BC\\."
      conceptType:
        equals_string: "biomedical_concept"

  # --------------------------------------------------------------------------
  # Method Hierarchy
  # --------------------------------------------------------------------------

  AbstractMethod:
    abstract: true
    description: >-
      Abstract base class for all methods (StatisticalMethod, DerivationMethod).
      Defines shared properties inherited by all method types, including support
      for multi-language implementations.
    slots:
      - OID
      - name
      - description
      - methodType
      - methodCategory
      - semanticRole
      - statoIRI
      - implementations
    slot_usage:
      OID:
        required: true
        identifier: true
        pattern: "^METHOD\\."
      name:
        required: true
      methodType:
        required: true
      methodCategory:
        required: true

  StatisticalMethod:
    is_a: AbstractMethod
    description: >-
      Statistical analysis method specification. Includes formal mathematical
      specification and multi-language implementations for complex statistical
      analyses like ANCOVA, t-tests, regression models, etc.
    slots:
      - statisticalMethodType
      - modelFamily
      - linkFunction
      - modelFormulation
      - assumptions
      - outputs
    slot_usage:
      methodType:
        equals_string: "statistical_method"
      methodCategory:
        required: true
      outputs:
        required: true
        multivalued: true

  # --------------------------------------------------------------------------
  # Component Classes
  # --------------------------------------------------------------------------

  ConceptInput:
    description: >-
      Input specification for analysis or data concepts. Defines what data
      or information is required as input to an analysis or data derivation.
    slots:
      - OID
      - name
      - semanticRole
      - description
      - dataType
      - required
      - cardinality
      - implementsConcept
      - conceptRef
      - semanticType
    slot_usage:
      OID:
        required: true
        identifier: true
      name:
        required: true
      semanticRole:
        required: true
      required:
        range: boolean

  ConceptOutput:
    description: >-
      Output specification for analysis or data concepts. Defines what results
      or derived values are produced by an analysis or data derivation.
    slots:
      - OID
      - name
      - semanticRole
      - description
      - dataType
      - interpretation
      - cardinality
      - semanticType
      - statoIRI
    slot_usage:
      OID:
        required: true
        identifier: true
      name:
        required: true
      semanticRole:
        required: true

  TemplateParameter:
    description: >-
      Parameter definition for building block templates. Defines a placeholder
      in a phrase template that must be filled during sentence composition.
    slots:
      - name
      - description
      - semanticType
      - required
      - cardinality
      - examples
    slot_usage:
      name:
        required: true
        identifier: true
      description:
        required: true
      semanticType:
        required: true
      required:
        range: boolean

  BuildingBlockReference:
    description: >-
      Reference to a building block with semantic role and parameter mappings.
      Used by AnalysisConcept to declare which building blocks are needed
      for sentence composition.
    slots:
      - buildingBlockRef
      - semanticRole
      - description
      - required
      - parameterMappings
    slot_usage:
      buildingBlockRef:
        required: true
      semanticRole:
        required: true
      required:
        range: boolean

  ParameterMapping:
    description: >-
      Bidirectional mapping between building block parameters and concept
      inputs/outputs. A building block parameter can either provide an input
      to the concept OR describe an output from the concept.
    slots:
      - buildingBlockParameter
      - mapsToInput
      - mapsToOutput
      - mappingType
      - description
    slot_usage:
      buildingBlockParameter:
        required: true
      mappingType:
        required: true

  DerivationMethod:
    is_a: AbstractMethod
    description: >-
      Lightweight formula-based derivation method. Used by DerivationConcept
      when the concept represents a derived value computed via mathematical
      formula (e.g., CHG = AVAL - BASE).
    slots:
      - formula
    slot_usage:
      methodType:
        equals_string: "derivation_method"

  MethodReference:
    description: >-
      Reference to a statistical method with semantic role.
    slots:
      - methodOID
      - semanticRole
      - description
    slot_usage:
      methodOID:
        required: true
      semanticRole:
        required: true

  DerivationConceptReference:
    description: >-
      Reference to a derivation concept with semantic role.
    slots:
      - derivationConceptOID
      - semanticRole
      - description
    slot_usage:
      derivationConceptOID:
        required: true
      semanticRole:
        required: true

  AnalysisConceptReference:
    description: >-
      Reference to an analysis concept with semantic role.
    slots:
      - analysisConceptOID
      - semanticRole
      - description
    slot_usage:
      analysisConceptOID:
        required: true
      semanticRole:
        required: true

  BiomedicalConceptReference:
    description: >-
      Reference to a biomedical concept with semantic role.
    slots:
      - biomedicalConceptOID
      - semanticRole
      - description
    slot_usage:
      biomedicalConceptOID:
        required: true
      semanticRole:
        required: true

  MethodImplementation:
    description: >-
      Implementation of a method in a specific programming language.
    slots:
      - language
      - library
      - procedure
      - code
      - description
    slot_usage:
      language:
        required: true
      code:
        required: true

  CodelistReference:
    description: >-
      Reference to a controlled terminology codelist.
    slots:
      - codelistOID
      - description
    slot_usage:
      codelistOID:
        required: true

  # --------------------------------------------------------------------------
  # Container Classes
  # --------------------------------------------------------------------------

  ConceptLibrary:
    tree_root: true
    description: >-
      Root container for a library of reified concepts. Can contain any
      combination of AnalysisConcepts, DerivationConcepts, BuildingBlocks,
      BiomedicalConcepts, and Methods.
    slots:
      - libraryOID
      - libraryName
      - version
      - concepts
      - methods
    slot_usage:
      libraryOID:
        required: true
        identifier: true
      libraryName:
        required: true
      concepts:
        multivalued: true
        any_of:
          - range: AnalysisConcept
          - range: DerivationConcept
          - range: BuildingBlock
          - range: BiomedicalConcept

# ============================================================================
# SLOTS - Property Definitions
# ============================================================================

slots:

  # --------------------------------------------------------------------------
  # Base Properties (Shared by All Concepts)
  # --------------------------------------------------------------------------

  OID:
    description: Unique identifier with type-specific prefix
    identifier: true
    required: true
    range: string

  name:
    description: Human-readable name
    required: true
    range: string
    slot_uri: dcterms:title

  description:
    description: Detailed description of the concept
    range: string
    slot_uri: dcterms:description

  conceptType:
    description: Type discriminator enum
    required: true
    range: string

  semanticRole:
    description: Domain-specific semantic role
    required: true
    range: string

  label:
    description: Short display label
    range: string
    slot_uri: schema:name

  statoIRI:
    description: STATO ontology IRI reference
    range: uriorcurie
    slot_uri: obo:IAO_0000136

  # --------------------------------------------------------------------------
  # AnalysisConcept Properties
  # --------------------------------------------------------------------------

  purpose:
    description: Analysis purpose (e.g., 'Hypothesis test for dose-response')
    required: true
    range: string

  requiredBuildingBlocks:
    description: Building blocks needed for sentence composition
    multivalued: true
    range: BuildingBlockReference
    inlined_as_list: true

  requiresPopulation:
    description: Whether population specification is required
    range: boolean

  allowedDataConcepts:
    description: Derivation concepts compatible with this analysis
    multivalued: true
    range: string

  # --------------------------------------------------------------------------
  # DerivationConcept Properties
  # --------------------------------------------------------------------------

  adClass:
    description: ADaM variable class
    range: AdamClassEnum

  dataType:
    description: Expected data type
    range: DataTypeEnum

  derivationMethod:
    description: Derivation specification for computed concepts
    range: DerivationMethod
    inlined: true

  mapsToVariable:
    description: SDTM/ADaM variable names implementing this concept
    multivalued: true
    range: string

  # --------------------------------------------------------------------------
  # BuildingBlock Properties
  # --------------------------------------------------------------------------

  template:
    description: Phrase template with parameter placeholders (e.g., '{parameter}')
    required: true
    range: string

  parameters:
    description: Template parameter definitions
    required: true
    multivalued: true
    range: TemplateParameter
    inlined_as_list: true

  mapsToDataConcept:
    description: Derivation concepts required by this phrase
    multivalued: true
    range: string

  requiresAnalysisConcept:
    description: Analysis concepts that can use this building block
    multivalued: true
    range: string

  examples:
    description: Example instantiations of the template
    multivalued: true
    range: string

  # --------------------------------------------------------------------------
  # BiomedicalConcept Properties
  # --------------------------------------------------------------------------

  biomedicalDomain:
    description: Biomedical domain (e.g., 'adverse_event', 'vital_signs')
    range: string

  ctCodelistRef:
    description: Reference to controlled terminology codelist
    range: CodelistReference
    inlined: true

  relatedDataConcepts:
    description: Related derivation concepts
    multivalued: true
    range: string

  implementationGuidance:
    description: Informational guidance for implementation (not authoritative)
    range: string

  # --------------------------------------------------------------------------
  # Method Properties
  # --------------------------------------------------------------------------

  methodCategory:
    description: Category of method
    required: true
    range: MethodCategoryEnum

  methodType:
    description: Type discriminator for method hierarchy
    required: true
    range: string
    designates_type: true

  statisticalMethodType:
    description: Specific type of statistical method
    range: MethodTypeEnum

  implementations:
    description: Method implementations in various languages
    multivalued: true
    range: MethodImplementation
    inlined_as_list: true

  # --------------------------------------------------------------------------
  # Input/Output Properties
  # --------------------------------------------------------------------------

  inputs:
    description: Typed input specifications
    multivalued: true
    range: ConceptInput
    inlined_as_list: true

  outputs:
    description: Typed output specifications
    multivalued: true
    range: ConceptOutput
    inlined_as_list: true

  required:
    description: Whether this element is required
    range: boolean

  cardinality:
    description: Cardinality constraint (e.g., '1', '0..1', '1..*', '0..*')
    range: string

  implementsConcept:
    description: Reference to DerivationConcept(s) or BiomedicalConcept(s) that this element implements
    multivalued: true
    range: string

  conceptRef:
    description: Reference to concept OID
    multivalued: true
    range: string

  semanticType:
    description: Semantic type or ontology reference
    range: uriorcurie

  interpretation:
    description: How to interpret this output
    range: string

  # --------------------------------------------------------------------------
  # BuildingBlockReference Properties
  # --------------------------------------------------------------------------

  buildingBlockRef:
    description: OID reference to BuildingBlock
    required: true
    range: string

  parameterMappings:
    description: Mappings between building block parameters and concept inputs/outputs
    multivalued: true
    range: ParameterMapping
    inlined_as_list: true

  # --------------------------------------------------------------------------
  # ParameterMapping Properties
  # --------------------------------------------------------------------------

  buildingBlockParameter:
    description: Name of parameter in building block template
    required: true
    range: string

  mapsToInput:
    description: OID of ConceptInput this parameter provides
    range: string

  mapsToOutput:
    description: OID of ConceptOutput this parameter describes
    range: string

  mappingType:
    description: Type of mapping (provides_input or describes_output)
    required: true
    range: MappingTypeEnum

  # --------------------------------------------------------------------------
  # Method-Related Properties
  # --------------------------------------------------------------------------

  methodOID:
    description: Reference to Method OID
    range: string

  derivationConceptOID:
    description: Reference to DerivationConcept OID
    range: string

  analysisConceptOID:
    description: Reference to AnalysisConcept OID
    range: string

  biomedicalConceptOID:
    description: Reference to BiomedicalConcept OID
    range: string

  methodReferences:
    description: References to statistical methods
    multivalued: true
    range: MethodReference
    inlined_as_list: true

  requiredDerivationConcepts:
    description: Derivation concepts required by this analysis
    multivalued: true
    range: DerivationConceptReference
    inlined_as_list: true

  requiredAnalysisConcepts:
    description: Analysis concepts required by this analysis
    multivalued: true
    range: AnalysisConceptReference
    inlined_as_list: true

  requiredBiomedicalConcepts:
    description: Biomedical concepts required by this analysis
    multivalued: true
    range: BiomedicalConceptReference
    inlined_as_list: true

  formula:
    description: Mathematical formula or expression
    range: string

  modelFamily:
    description: Statistical model family (e.g., 'gaussian', 'binomial')
    range: string

  linkFunction:
    description: Link function for GLM (e.g., 'identity', 'logit')
    range: string

  modelFormulation:
    description: Model formulation specification
    range: string

  assumptions:
    description: Model or method assumptions
    multivalued: true
    range: string

  # --------------------------------------------------------------------------
  # MethodImplementation Properties
  # --------------------------------------------------------------------------

  language:
    description: Programming language
    required: true
    range: ImplementationLanguageEnum

  library:
    description: Software library or package name
    range: string

  procedure:
    description: Procedure name (for SAS)
    range: string

  code:
    description: Implementation code
    required: true
    range: string

  # --------------------------------------------------------------------------
  # CodelistReference Properties
  # --------------------------------------------------------------------------

  codelistOID:
    description: OID of the codelist
    required: true
    range: string

  # --------------------------------------------------------------------------
  # Container Properties
  # --------------------------------------------------------------------------

  libraryOID:
    description: Library identifier
    identifier: true
    range: string

  libraryName:
    description: Library name
    range: string

  version:
    description: Library or object version
    range: string

  concepts:
    description: Collection of reified concepts
    multivalued: true
    range: ReifiedConcept
    inlined_as_list: true

  methods:
    description: Collection of methods
    multivalued: true
    range: AbstractMethod
    inlined_as_list: true
