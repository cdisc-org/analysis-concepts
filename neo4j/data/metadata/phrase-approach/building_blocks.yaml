# ===========================================================================
# BUILDING BLOCKS: Reusable Phrase Templates
# ===========================================================================
#
# Building blocks are reusable natural language templates that compose
# into complete analysis descriptions. Each block has typed slots that
# map to specific concepts.
#
# Categories:
#   - Outcome: Dependent variables and derived measures
#   - Predictor: Independent variables and treatment factors
#   - Population: Record selection and subject criteria
#   - Method: Statistical approaches and models
#   - Temporal: Time references and visit specifications
#   - Covariate: Adjustment variables
#
# ===========================================================================

building_blocks:

  # =========================================================================
  # OUTCOME BLOCKS (Dependent Variables)
  # =========================================================================

  - id: BB.OUTCOME.CHG_PARAM_TIME
    category: Outcome
    label: "Change from Baseline to Timepoint"
    template: "change in {parameter} from baseline to {timepoint}"
    description: "Describes change in a parameter from baseline to a specific analysis timepoint"

    slots:
      - name: parameter
        label: "Parameter"
        type: continuous_measure
        required: true
        description: "The measure being analyzed (e.g., ADAS-Cog Total Score)"
        accepts:
          - derived_measures
          - biomedical_concepts

      - name: timepoint
        label: "Analysis Timepoint"
        type: temporal_reference
        required: true
        description: "Time point for analysis (e.g., Week 24, Month 6)"

    maps_to_concept: DC.CHANGE_FROM_BASELINE
    example: "change in ADAS-Cog (11) Total Score from baseline to Week 24"

  - id: BB.OUTCOME.PARAM_AT_TIME
    category: Outcome
    label: "Parameter at Timepoint"
    template: "{parameter} at {timepoint}"
    description: "Value of parameter at specific timepoint"

    slots:
      - name: parameter
        label: "Parameter"
        type: continuous_measure
        required: true
        description: "The measure being assessed"

      - name: timepoint
        label: "Timepoint"
        type: temporal_reference
        required: true
        description: "Analysis timepoint"

    maps_to_concept: DC.ANALYSIS_VALUE
    example: "ADAS-Cog (11) Total Score at Week 24"

  # =========================================================================
  # PREDICTOR BLOCKS (Independent Variables)
  # =========================================================================

  - id: BB.PREDICTOR.TRT_CONTINUOUS
    category: Predictor
    label: "Treatment as Continuous Predictor"
    template: "with {treatment} as continuous predictor"
    description: "Treatment or dose modeled as continuous numeric variable"

    slots:
      - name: treatment
        label: "Treatment Variable"
        type: continuous_predictor
        required: true
        description: "Treatment dose as numeric"

    maps_to_concept: DC.TREATMENT_NUMERIC
    example: "with treatment as continuous predictor"

  - id: BB.PREDICTOR.TRT_GROUPS
    category: Predictor
    label: "Treatment Groups"
    template: "comparing {treatment} groups"
    description: "Categorical treatment comparison"

    slots:
      - name: treatment
        label: "Treatment Variable"
        type: categorical_predictor
        required: true
        description: "Treatment groups as categories"

    maps_to_concept: DC.TREATMENT_CATEGORICAL
    example: "comparing treatment groups"

  # =========================================================================
  # COVARIATE BLOCKS (Adjustment Variables)
  # =========================================================================

  - id: BB.COVARIATE.ADJUST_FOR
    category: Covariate
    label: "Adjusting for Covariates"
    template: "adjusting for {baseline} and {site}"
    description: "Specify adjustment variables in model"

    slots:
      - name: baseline
        label: "Baseline Covariate"
        type: continuous_measure
        required: true
        description: "Baseline value as covariate"

      - name: site
        label: "Site Covariate"
        type: categorical_variable
        required: true
        description: "Site grouping variable"

    example: "adjusting for baseline score and site"

  # =========================================================================
  # POPULATION BLOCKS (Record Selection)
  # =========================================================================

  - id: BB.POPULATION.IN_POPULATION
    category: Population
    label: "In Population"
    template: "in {population_name} population"
    description: "Specify analysis population"

    slots:
      - name: population_name
        label: "Population Name"
        type: population_identifier
        required: true
        description: "Analysis population (e.g., efficacy, safety, ITT)"

    maps_to_concept: DC.POPULATION_DEFINITION
    example: "in efficacy population"

  - id: BB.POPULATION.WHERE_FLAGS
    category: Population
    label: "Where Flags Equal Y"
    template: "where {flag1}='Y' and {flag2}='Y'"
    description: "Record selection using flag variables"

    slots:
      - name: flag1
        label: "Flag 1"
        type: flag_variable
        required: true
        description: "First selection flag"

      - name: flag2
        label: "Flag 2"
        type: flag_variable
        required: false
        description: "Optional second flag"

    example: "where EFFFL='Y' and ANL01FL='Y'"

  # =========================================================================
  # METHOD BLOCKS (Statistical Approaches)
  # =========================================================================

  - id: BB.METHOD.LINEAR_MODEL
    category: Method
    label: "Linear Model"
    template: "using linear model"
    description: "Linear regression analysis"

    slots: []

    maps_to_concept: AC.LINEAR_REGRESSION
    example: "using linear model"

  - id: BB.METHOD.ANCOVA_MODEL
    category: Method
    label: "ANCOVA Model"
    template: "using ANCOVA model"
    description: "Analysis of covariance"

    slots: []

    maps_to_concept: AC.ANCOVA
    example: "using ANCOVA model"

  - id: BB.METHOD.DOSE_RESPONSE_TEST
    category: Method
    label: "Dose Response Test"
    template: "testing for dose-response relationship"
    description: "Test for trend across dose levels"

    slots: []

    example: "testing for dose-response relationship"

  - id: BB.METHOD.LOCF
    category: Method
    label: "LOCF Imputation"
    template: "with LOCF imputation for missing values"
    description: "Last observation carried forward"

    slots: []

    maps_to_concept: DC.LOCF_IMPUTATION
    example: "with LOCF imputation for missing values"

  # =========================================================================
  # TEMPORAL BLOCKS (Time References)
  # =========================================================================

  - id: BB.TEMPORAL.AT_TIMEPOINT
    category: Temporal
    label: "At Timepoint"
    template: "at {timepoint}"
    description: "Specify analysis timepoint"

    slots:
      - name: timepoint
        label: "Timepoint"
        type: temporal_reference
        required: true
        description: "Visit or time reference"

    maps_to_concept: DC.ANALYSIS_VISIT
    example: "at Week 24"

  - id: BB.TEMPORAL.FROM_TO
    category: Temporal
    label: "From Baseline To Timepoint"
    template: "from {baseline_time} to {analysis_time}"
    description: "Time interval specification"

    slots:
      - name: baseline_time
        label: "Baseline Time"
        type: temporal_reference
        required: true
        default: "baseline"

      - name: analysis_time
        label: "Analysis Time"
        type: temporal_reference
        required: true

    example: "from baseline to Week 24"
